<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DJ Alamo — Official App</title>
<link rel="manifest" href="manifest.json">

<style>
  :root{
    --bg1:#0c1c3a;
    --bg2:#050b18;
    --card:rgba(255,255,255,0.06);
    --text:#eaf1ff;
    --muted:rgba(234,241,255,0.72);
    --btn1:#3b82f6;
    --btn2:#2563eb;
    --btnDark:#101828;
    --stroke:rgba(255,255,255,0.10);
    --good:#22c55e;
    --warn:#f59e0b;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    background:radial-gradient(circle at top, var(--bg1), var(--bg2));
    color:var(--text);
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    text-align:center;
    padding:18px 14px 22px;
  }
  .wrap{ max-width:500px; margin:0 auto; }
  .card{
    background:var(--card);
    border:1px solid var(--stroke);
    border-radius:22px;
    padding:18px 16px 16px;
    box-shadow:0 18px 50px rgba(0,0,0,0.40);
    backdrop-filter: blur(10px);
  }
  .logo{
    width:min(240px, 82vw);
    height:auto;
    display:block;
    margin:2px auto 8px;
    border-radius:18px;
  }
  .title{
    margin:6px 0 4px;
    font-size:18px;
    font-weight:900;
    letter-spacing:0.2px;
  }
  .desc{
    margin:6px auto 14px;
    color:var(--muted);
    font-size:14px;
    line-height:1.35;
    max-width:420px;
  }

  .tabs{
    display:flex;
    gap:8px;
    justify-content:center;
    margin:12px 0 10px;
    flex-wrap:wrap;
  }
  .tabBtn{
    appearance:none;
    border:none;
    border-radius:999px;
    padding:10px 12px;
    font-size:13px;
    font-weight:800;
    color:rgba(234,241,255,0.88);
    background:rgba(0,0,0,0.18);
    border:1px solid rgba(255,255,255,0.10);
  }
  .tabBtn.active{
    color:#fff;
    background:linear-gradient(135deg,var(--btn1),var(--btn2));
    border-color:rgba(255,255,255,0.06);
    box-shadow:0 10px 28px rgba(59,130,246,0.25);
  }

  .section{ display:none; text-align:left; }
  .section.active{ display:block; }

  .row{ display:flex; flex-wrap:wrap; justify-content:center; gap:10px; }
  button.primary{
    appearance:none;
    border:none;
    border-radius:14px;
    padding:13px 14px;
    min-width:150px;
    font-size:15px;
    font-weight:900;
    color:white;
    background:linear-gradient(135deg,var(--btn1),var(--btn2));
    box-shadow:0 10px 28px rgba(59,130,246,0.35);
  }
  button.secondary{
    appearance:none;
    border-radius:14px;
    padding:13px 14px;
    min-width:150px;
    font-size:15px;
    font-weight:900;
    color:white;
    background:linear-gradient(135deg,#172554,#0b1220);
    box-shadow:none;
    border:1px solid rgba(255,255,255,0.10);
  }
  button:disabled{ opacity:0.45; }
  button:active{ transform:scale(0.98); }

  .playerCard{
    margin-top:10px;
    border:1px solid rgba(255,255,255,0.10);
    background:rgba(0,0,0,0.16);
    border-radius:18px;
    padding:12px;
  }
  .nowPlaying{
    display:flex;
    gap:10px;
    align-items:center;
  }
  .cover{
    width:56px; height:56px;
    border-radius:14px;
    background:rgba(255,255,255,0.06);
    border:1px solid rgba(255,255,255,0.10);
    overflow:hidden;
    flex:0 0 auto;
  }
  .cover img{ width:100%; height:100%; object-fit:cover; display:block; }
  .npText{ flex:1; min-width:0; }
  .npTitle{
    font-weight:900;
    font-size:14px;
    margin:0;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .npMeta{
    margin-top:2px;
    font-size:12px;
    color:rgba(234,241,255,0.70);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  audio{
    width:100%;
    margin-top:10px;
    border-radius:14px;
  }

  .list{
    margin-top:12px;
    display:grid;
    gap:10px;
  }
  .track{
    display:flex;
    gap:10px;
    align-items:center;
    padding:12px;
    border-radius:18px;
    background:rgba(255,255,255,0.04);
    border:1px solid rgba(255,255,255,0.10);
    cursor:pointer;
    user-select:none;
  }
  .track:active{ transform:scale(0.99); }
  .track .tCover{
    width:46px; height:46px;
    border-radius:14px;
    background:rgba(255,255,255,0.06);
    border:1px solid rgba(255,255,255,0.10);
    overflow:hidden;
    flex:0 0 auto;
  }
  .track .tCover img{ width:100%; height:100%; object-fit:cover; display:block; }
  .track .tText{ flex:1; min-width:0; }
  .track .tTitle{
    font-weight:900;
    font-size:14px;
    margin:0;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .track .tSub{
    margin-top:2px;
    font-size:12px;
    color:rgba(234,241,255,0.70);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .pill{
    font-size:11px;
    font-weight:900;
    padding:6px 8px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,0.10);
    background:rgba(0,0,0,0.18);
    color:rgba(234,241,255,0.82);
  }

  .adSlot{
    margin-top:12px;
    border-radius:18px;
    border:1px dashed rgba(255,255,255,0.22);
    background:rgba(0,0,0,0.14);
    padding:12px;
    text-align:center;
  }
  .adLabel{
    font-size:11px;
    font-weight:900;
    letter-spacing:0.6px;
    color:rgba(234,241,255,0.60);
    text-transform:uppercase;
    margin-bottom:8px;
  }
  .adInner{
    border-radius:14px;
    padding:12px;
    background:rgba(255,255,255,0.04);
    border:1px solid rgba(255,255,255,0.10);
    color:rgba(234,241,255,0.80);
    font-size:13px;
    line-height:1.3;
  }

  .status{
    margin-top:10px;
    color:rgba(234,241,255,0.72);
    font-size:13px;
    min-height:18px;
    text-align:center;
  }
  .mini{
    font-size:11px;
    color:rgba(234,241,255,0.55);
    text-align:center;
    margin-top:10px;
  }

  .badge{
    display:inline-flex;
    gap:6px;
    align-items:center;
    justify-content:center;
    font-size:12px;
    font-weight:900;
    padding:8px 10px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,0.10);
    background:rgba(0,0,0,0.18);
    color:rgba(234,241,255,0.82);
  }
  .dot{ width:8px; height:8px; border-radius:999px; background:var(--good); display:inline-block; }

  /* subtle nostalgic overlay (safe) */
  body::after{
    content:"";
    position:fixed;
    inset:0;
    pointer-events:none;
    background:
      radial-gradient(circle at center, transparent 58%, rgba(0,0,0,0.35)),
      repeating-linear-gradient(to bottom,
        rgba(255,255,255,0.02), rgba(255,255,255,0.02) 1px,
        transparent 2px, transparent 4px
      );
    mix-blend-mode:overlay;
  }
</style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <!-- Replace logo.png with dj-alamo.png (or keep logo.png) -->
      <img src="dj-alamo.png" class="logo" alt="DJ Alamo logo" onerror="this.style.display='none';" />

      <div class="title">DJ Alamo</div>
      <div class="desc">
        Official app — mixes, drops, and exclusives. No algorithm. Just the music.
      </div>

      <div class="row" style="margin-bottom:8px;">
        <div class="badge"><span class="dot"></span> Pilot • Powered quietly by Base</div>
      </div>

      <div class="tabs">
        <button class="tabBtn active" data-tab="home">Home</button>
        <button class="tabBtn" data-tab="listen">Listen</button>
        <button class="tabBtn" data-tab="about">About</button>
      </div>

      <!-- HOME -->
      <div id="tab-home" class="section active">
        <div class="row" style="margin-top:6px;">
          <button id="goListen" class="primary">▶ Start Listening</button>
          <button id="installBtn" class="secondary" style="display:none;">➕ Install App</button>
        </div>

        <div class="playerCard" style="margin-top:12px;">
          <div style="font-weight:900; font-size:14px; text-align:center;">What this is</div>
          <div style="margin-top:6px; color:rgba(234,241,255,0.72); font-size:13px; line-height:1.35; text-align:center;">
            This is DJ Alamo’s space. Fans come direct. Ads are optional and kept light.
          </div>
        </div>

        <div class="adSlot">
          <div class="adLabel">Ad</div>
          <div class="adInner" id="adInner">
            Pilot Ad Slot (Banner).<br/>
            Brand-safe only. No tracking of personal fan data.
          </div>
        </div>
      </div>

      <!-- LISTEN -->
      <div id="tab-listen" class="section">
        <div class="playerCard">
          <div class="nowPlaying">
            <div class="cover" id="npCover">
              <img id="npCoverImg" src="" alt="" style="display:none;" />
            </div>
            <div class="npText">
              <p class="npTitle" id="npTitle">Select a track</p>
              <div class="npMeta" id="npMeta">Ready.</div>
            </div>
            <span class="pill" id="npPill">V1</span>
          </div>

          <audio id="audio" controls preload="none"></audio>

          <div class="row" style="margin-top:10px;">
            <button id="prevBtn" class="secondary" disabled>⏮ Prev</button>
            <button id="nextBtn" class="primary" disabled>Next ⏭</button>
          </div>
        </div>

        <div class="adSlot">
          <div class="adLabel">Ad</div>
          <div class="adInner" id="adInner2">
            Pilot Banner Slot — replace with sponsor image later.
          </div>
        </div>

        <div class="list" id="trackList" aria-label="Track list"></div>
      </div>

      <!-- ABOUT -->
      <div id="tab-about" class="section">
        <div class="playerCard">
          <div style="font-weight:900; font-size:14px; text-align:center;">DJ Alamo</div>
          <div style="margin-top:6px; color:rgba(234,241,255,0.72); font-size:13px; line-height:1.35; text-align:center;">
            Add your short bio here (1–2 sentences). Keep it simple.
          </div>
          <div class="row" style="margin-top:10px;">
            <span class="pill">No algorithm</span>
            <span class="pill">Direct to fans</span>
            <span class="pill">Artist-owned feel</span>
          </div>
        </div>

        <div class="playerCard" style="margin-top:12px;">
          <div style="font-weight:900; font-size:14px; text-align:center;">Ads</div>
          <div style="margin-top:6px; color:rgba(234,241,255,0.72); font-size:13px; line-height:1.35; text-align:center;">
            Ads are optional. For this pilot we keep them light and brand-safe.
          </div>
        </div>
      </div>

      <div id="status" class="status">Loading…</div>
      <div class="mini">V1 Pilot • On-device playback • No fan accounts • No uploads</div>
    </div>
  </div>

<script>
/**
 * BASE V1 — DJ Alamo Pilot App
 * - Web-first PWA
 * - Content loads from content.json (system-style)
 * - Simple player + track list
 * - Banner ad slot placeholder (pilot-safe)
 * - NO Fan Talk logic, NO recording, NO FX
 */

const statusEl = document.getElementById('status');
const tabs = document.querySelectorAll('.tabBtn');
const sections = {
  home: document.getElementById('tab-home'),
  listen: document.getElementById('tab-listen'),
  about: document.getElementById('tab-about')
};

const goListenBtn = document.getElementById('goListen');
const installBtn = document.getElementById('installBtn');

const audio = document.getElementById('audio');
const trackListEl = document.getElementById('trackList');
const npTitle = document.getElementById('npTitle');
const npMeta = document.getElementById('npMeta');
const npPill = document.getElementById('npPill');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');

const npCoverImg = document.getElementById('npCoverImg');

let tracks = [];
let currentIndex = -1;
let deferredPrompt = null;

function setStatus(t){ statusEl.textContent = t; }

function showTab(tab){
  tabs.forEach(b => b.classList.toggle('active', b.dataset.tab === tab));
  Object.keys(sections).forEach(k => sections[k].classList.toggle('active', k === tab));
}

tabs.forEach(btn => {
  btn.addEventListener('click', () => showTab(btn.dataset.tab));
});

goListenBtn.addEventListener('click', () => showTab('listen'));

prevBtn.addEventListener('click', () => {
  if(tracks.length < 1) return;
  const next = (currentIndex <= 0) ? tracks.length - 1 : currentIndex - 1;
  playIndex(next);
});
nextBtn.addEventListener('click', () => {
  if(tracks.length < 1) return;
  const next = (currentIndex >= tracks.length - 1) ? 0 : currentIndex + 1;
  playIndex(next);
});

audio.addEventListener('ended', () => {
  // Simple auto-next keeps sessions flowing (pilot-friendly)
  if(tracks.length > 1) nextBtn.click();
});

function renderTracks(){
  trackListEl.innerHTML = '';
  tracks.forEach((t, i) => {
    const item = document.createElement('div');
    item.className = 'track';
    item.setAttribute('role','button');
    item.setAttribute('tabindex','0');
    item.innerHTML = `
      <div class="tCover">
        <img src="${escapeHtml(t.cover || '')}" alt="" style="${t.cover ? '' : 'display:none;'}" />
      </div>
      <div class="tText">
        <p class="tTitle">${escapeHtml(t.title || 'Untitled')}</p>
        <div class="tSub">${escapeHtml(t.subtitle || '')}</div>
      </div>
      <span class="pill">${escapeHtml(t.tag || 'Play')}</span>
    `;
    item.addEventListener('click', () => playIndex(i));
    item.addEventListener('keydown', (e) => {
      if(e.key === 'Enter' || e.key === ' ') playIndex(i);
    });
    trackListEl.appendChild(item);
  });

  if(tracks.length){
    prevBtn.disabled = false;
    nextBtn.disabled = false;
    setStatus('Ready. Pick a track.');
  }else{
    setStatus('No tracks found. Add tracks to content.json.');
  }
}

function playIndex(i){
  const t = tracks[i];
  if(!t) return;

  currentIndex = i;
  npTitle.textContent = t.title || 'Untitled';
  npMeta.textContent = t.subtitle || 'Playing…';
  npPill.textContent = (t.tag || 'V1');

  // cover
  if(t.cover){
    npCoverImg.src = t.cover;
    npCoverImg.style.display = 'block';
  }else{
    npCoverImg.style.display = 'none';
    npCoverImg.src = '';
  }

  // set src and play
  audio.src = t.url;
  audio.play().then(() => {
    setStatus('Playing.');
  }).catch(() => {
    setStatus('Tap play to start audio (browser policy).');
  });
}

async function loadContent(){
  try{
    setStatus('Loading tracks…');
    const res = await fetch('content.json', { cache: 'no-store' });
    if(!res.ok) throw new Error('content.json not found');
    const json = await res.json();
    tracks = Array.isArray(json.tracks) ? json.tracks : [];
    renderTracks();
  }catch(err){
    console.error(err);
    setStatus('Could not load content.json. Make sure it exists in the same folder.');
  }
}

function escapeHtml(s){
  return String(s || '')
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;')
    .replaceAll("'","&#039;");
}

// PWA install prompt (simple, optional)
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  installBtn.style.display = 'inline-block';
});

installBtn.addEventListener('click', async () => {
  if(!deferredPrompt) return;
  deferredPrompt.prompt();
  try{ await deferredPrompt.userChoice; }catch(e){}
  deferredPrompt = null;
  installBtn.style.display = 'none';
});

// Service worker registration (safe)
if('serviceWorker' in navigator){
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./service-worker.js').catch(()=>{});
  });
}

// Start
showTab('home');
loadContent();
setStatus('Ready.');
</script>
</body>
</html>
